{% extends 'base.html' %}
{% load static %} <!-- Add this line to use the static template tag -->

{% block title %}Find a Doctor{% endblock %}

{% block content %}
<h2>Our Doctors</h2>
<p>Find the right specialist for your needs.</p>

<!-- Search and Filter Form can be added here -->

<div class="row">
    {% for doctor in doctors %}
    <div class="col-md-6 mb-4">
        <div class="card">
            <div class="card-body d-flex">
                
                <!-- CORRECTED IMAGE HANDLING -->
                {% if doctor.user.profile.profile_picture %}
                    <img src="{{ doctor.user.profile.profile_picture.url }}" alt="Dr. {{ doctor.user.get_full_name }}" class="rounded-circle me-3" style="width: 100px; height: 100px; object-fit: cover;">
                {% else %}
                    <!-- Make sure you have a default image at 'static/images/default_avatar.png' -->
                    <img src="{% static 'images/default_avatar.png' %}" alt="Default Avatar" class="rounded-circle me-3" style="width: 100px; height: 100px; object-fit: cover;">
                {% endif %}
                
                <div>
                    <h4>Dr. {{ doctor.user.get_full_name }}</h4>
                    <p class="text-muted">
                        {% for spec in doctor.specializations.all %}
                            {{ spec.name }}{% if not forloop.last %}, {% endif %}
                        {% endfor %}
                    </p>
                    <p><strong>Experience:</strong> {{ doctor.experience_years }} years</p>
                    <p><strong>Fee:</strong> ${{ doctor.consultation_fee }}</p>
                    <a href="{% url 'doctor_detail' doctor.pk %}" class="btn btn-sm btn-primary">View Profile & Book</a>
                </div>
            </div>
        </div>
    </div>
    {% empty %}
    <div class="col-12">
        <p>No doctors found.</p>
    </div>
    {% endfor %}
</div>
{% endblock %}